import{j as s,a4 as U,a5 as p,B as I,T as O,aj as Y,a6 as B,r as d,ak as K,al as V,a7 as z,V as G,I as x,R as q,K as D,Y as Q,Z,$ as H,a0 as A,am as L,an as N,ao as R,a8 as J,a9 as X,aa as w,ab as ee,a2 as se,ac as W,o as ne,p as te,C as re,ad as ae,ae as ie,af as le,ag as M,ah as ce,ai as oe,H as de,q as ue}from"./index-Ca9vWsGo.js";function he({searchQuery:e,...a}){return s.jsx(U,{...a,children:s.jsx(p,{align:"center",colSpan:7,children:s.jsxs(I,{sx:{py:15,textAlign:"center"},children:[s.jsx(O,{variant:"h6",sx:{mb:1},children:"Not found"}),s.jsxs(O,{variant:"body2",children:["No results found for Â ",s.jsxs("strong",{children:['"',e,'"']}),".",s.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function ge({row:e,selected:a,onSelectRow:t}){const r=Y(),c=B(),[h,l]=d.useState(!1),[i,o]=d.useState(""),[v,S]=d.useState(""),[$,_]=d.useState(null),T=d.useCallback(m=>{_(m.currentTarget)},[]),y=d.useCallback(()=>{_(null)},[]),E=()=>{const m={...e,status:"suspended"},k=L.updateUser(m);N.promise(k,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:n}){var u;r(R(!1));const j=((u=n==null?void 0:n.data)==null?void 0:u.message)||"User account suspended successfully";return l(!1),`${j}`}},error:{render({data:n}){var u,b,P,C;return r(R(!1)),console.log("ERRO ON TOAST HERE :: ",(b=(u=n==null?void 0:n.response)==null?void 0:u.data)==null?void 0:b.message),`${(((C=(P=n==null?void 0:n.response)==null?void 0:P.data)==null?void 0:C.message)||(n==null?void 0:n.message)||"")??"An error occurred!"}`}}})},g=()=>{const m={...e,status:"active"},k=L.updateUser(m);N.promise(k,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:n}){var u;r(R(!1));const j=((u=n==null?void 0:n.data)==null?void 0:u.message)||"User account suspended successfully";return l(!1),`${j}`}},error:{render({data:n}){var u,b,P,C;return r(R(!1)),console.log("ERRO ON TOAST HERE :: ",(b=(u=n==null?void 0:n.response)==null?void 0:u.data)==null?void 0:b.message),`${(((C=(P=n==null?void 0:n.response)==null?void 0:P.data)==null?void 0:C.message)||(n==null?void 0:n.message)||"")??"An error occurred!"}`}}})},f=()=>{const m={...e,status:"deleted"},k=L.updateUser(m);N.promise(k,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:n}){var u;r(R(!1));const j=((u=n==null?void 0:n.data)==null?void 0:u.message)||"User account suspended successfully";return l(!1),`${j}`}},error:{render({data:n}){var u,b,P,C;return r(R(!1)),console.log("ERRO ON TOAST HERE :: ",(b=(u=n==null?void 0:n.response)==null?void 0:u.data)==null?void 0:b.message),`${(((C=(P=n==null?void 0:n.response)==null?void 0:P.data)==null?void 0:C.message)||(n==null?void 0:n.message)||"")??"An error occurred!"}`}}})};return s.jsxs(s.Fragment,{children:[s.jsx(K,{open:h,setOpen:l,title:i,body:s.jsx(V,{setOpen:l,message:v,action:()=>i.toLowerCase().startsWith("suspend")?E():i.toLowerCase().startsWith("pardon")?g():i.toLowerCase().startsWith("delete")?f():{}})}),s.jsxs(U,{hover:!0,tabIndex:-1,role:"checkbox",selected:a,children:[s.jsx(p,{padding:"checkbox",children:s.jsx(z,{disableRipple:!0,checked:a,onChange:t})}),s.jsx(p,{component:"th",scope:"row",children:s.jsxs(I,{gap:2,display:"flex",alignItems:"center",children:[s.jsx(G,{alt:e.name,src:e.photoUrl}),`${e.first_name} ${e.last_name}`]})}),s.jsx(p,{children:e.email_address}),s.jsx(p,{children:e.international_phone_format}),s.jsx(p,{children:(e==null?void 0:e.dob)&&new Date(e==null?void 0:e.dob).toLocaleDateString("en-US")}),s.jsx(p,{align:"center",children:e.is_email_verified?s.jsx(x,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}}):"-"}),s.jsx(p,{align:"center",children:e.is_profile_set?s.jsx(x,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}}):s.jsx(x,{width:22,icon:"solar:check-circle-bold",sx:{color:"warning.main"}})}),s.jsx(p,{children:s.jsx(q,{label:e.status,sx:{color:e.status==="active"?"green":"red",textTransform:"capitalize"}})}),s.jsx(p,{align:"right",children:s.jsx(D,{onClick:T,children:s.jsx(x,{icon:"eva:more-vertical-fill"})})})]}),s.jsx(Q,{open:!!$,anchorEl:$,onClose:y,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:s.jsxs(Z,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${H.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${H.selected}`]:{bgcolor:"action.selected"}}},children:[s.jsxs(A,{onClick:()=>{c(`/dashboard/users/${e==null?void 0:e.id}`,{state:{data:e}})},children:[s.jsx(x,{icon:"solar:eye-bold"}),"View"]}),(e==null?void 0:e.status)==="active"?s.jsxs(A,{onClick:()=>{o(`Suspend ${e==null?void 0:e.first_name}`),S(`Are you sure you want to suspend ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name}? You can pardon this user later.`),y(),l(!0)},sx:{color:"warning.main"},children:[s.jsx(x,{icon:"lsicon:suspend-filled"}),"Suspend"]}):s.jsxs(A,{onClick:()=>{o(`Pardon ${e==null?void 0:e.first_name}`),S(`Are you sure you want to pardon ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name}? You can always suspend this user later.`),y(),l(!0)},sx:{color:"info.main"},children:[s.jsx(x,{icon:"mage:user-check-fill"}),"Pardon"]}),(e==null?void 0:e.status)!=="deleted"&&s.jsxs(A,{onClick:()=>{o(`Delete ${e==null?void 0:e.first_name}'s Account`),S(`Are you sure you want to remove ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name} account from the platform? Action is irreversible.`),y(),l(!0)},sx:{color:"error.main"},children:[s.jsx(x,{icon:"fluent:person-delete-24-filled"}),"Delete"]})]})})]})}const pe={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function xe(e,a,t){return e?Math.max(0,(1+e)*a-t):0}function F(e,a,t){return a[t]<e[t]?-1:a[t]>e[t]?1:0}function me(e,a){return e==="desc"?(t,r)=>F(t,r,a):(t,r)=>-F(t,r,a)}function fe({inputData:e,comparator:a,filterName:t}){const r=e.map((c,h)=>[c,h]);return r.sort((c,h)=>{const l=a(c[0],h[0]);return l!==0?l:c[1]-h[1]}),e=r.map(c=>c[0]),t&&(e=e.filter(c=>`${c.first_name} ${c.last_name}`.toLowerCase().indexOf(t.toLowerCase())!==-1)),e}function je({order:e,onSort:a,orderBy:t,rowCount:r,headLabel:c,numSelected:h,onSelectAllRows:l}){return s.jsx(J,{children:s.jsxs(U,{children:[s.jsx(p,{padding:"checkbox",children:s.jsx(z,{indeterminate:h>0&&h<r,checked:r>0&&h===r,onChange:i=>l(i.target.checked)})}),c.map(i=>s.jsx(p,{align:i.align||"left",sortDirection:t===i.id?e:!1,sx:{width:i.width,minWidth:i.minWidth},children:s.jsxs(X,{hideSortIcon:!0,active:t===i.id,direction:t===i.id?e:"asc",onClick:()=>a(i.id),children:[i.label,t===i.id?s.jsx(I,{sx:{...pe},children:e==="desc"?"sorted descending":"sorted ascending"}):null]})},i.id))]})})}function be({emptyRows:e,height:a,sx:t,...r}){return e?s.jsx(U,{sx:{...a&&{height:a*e},...t},...r,children:s.jsx(p,{colSpan:9})}):null}function Pe({numSelected:e,filterName:a,onFilterName:t}){return s.jsxs(w,{sx:{height:96,display:"flex",justifyContent:"space-between",p:r=>r.spacing(0,1,0,3),...e>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[e>0?s.jsxs(O,{component:"div",variant:"subtitle1",children:[e," selected"]}):s.jsx(ee,{fullWidth:!0,value:a,onChange:t,placeholder:"Search user...",startAdornment:s.jsx(se,{position:"start",children:s.jsx(x,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),e>0?s.jsx(W,{title:"Delete",children:s.jsx(D,{children:s.jsx(x,{icon:"solar:trash-bin-trash-bold"})})}):s.jsx(W,{title:"Filter list",children:s.jsx(D,{children:s.jsx(x,{icon:"ic:round-filter-list"})})})]})}function Ce(){var l,i;const e=Se(),[a,t]=d.useState(""),{users:r}=ne(o=>o.user),c=fe({inputData:r==null?void 0:r.data,comparator:me(e.order,e.orderBy),filterName:a}),h=!c.length&&!!a;return s.jsxs(te,{children:[s.jsx(I,{display:"flex",alignItems:"center",mb:5,children:s.jsx(O,{variant:"h4",flexGrow:1,children:"Users"})}),s.jsxs(re,{children:[s.jsx(Pe,{numSelected:e.selected.length,filterName:a,onFilterName:o=>{t(o.target.value),e.onResetPage()}}),s.jsx(ae,{children:s.jsx(ie,{sx:{overflow:"unset"},children:s.jsxs(le,{sx:{minWidth:800},children:[s.jsx(je,{order:e.order,orderBy:e.orderBy,rowCount:(l=M)==null?void 0:l.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:o=>{var v;return e.onSelectAllRows(o,(v=M)==null?void 0:v.map(S=>S.id))},headLabel:[{id:"name",label:"Name"},{id:"email_address",label:"Email Address"},{id:"phone_number",label:"Phone Number"},{id:"dob",label:"DOB"},{id:"isVerified",label:"Verified",align:"center"},{id:"isKYC",label:"KYC Status",align:"center"},{id:"status",label:"Status",align:"center"},{id:""}]}),s.jsxs(ce,{children:[(i=c==null?void 0:c.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage))==null?void 0:i.map(o=>s.jsx(ge,{row:o,selected:e.selected.includes(o.id),onSelectRow:()=>e.onSelectRow(o.id)},o.id)),s.jsx(be,{height:68,emptyRows:xe(e.page,e.rowsPerPage,M.length)}),h&&s.jsx(he,{searchQuery:a})]})]})})}),s.jsx(oe,{component:"div",page:e.page,count:r==null?void 0:r.totalItems,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:e.onChangeRowsPerPage})]})]})}function Se(){const[e,a]=d.useState(0),[t,r]=d.useState("name"),[c,h]=d.useState(5),[l,i]=d.useState([]),[o,v]=d.useState("asc"),S=d.useCallback(g=>{v(t===g&&o==="asc"?"desc":"asc"),r(g)},[o,t]),$=d.useCallback((g,f)=>{if(g){i(f);return}i([])},[]),_=d.useCallback(g=>{const f=l.includes(g)?l.filter(m=>m!==g):[...l,g];i(f)},[l]),T=d.useCallback(()=>{a(0)},[]),y=d.useCallback((g,f)=>{a(f)},[]),E=d.useCallback(g=>{h(parseInt(g.target.value,10)),T()},[T]);return{page:e,order:o,onSort:S,orderBy:t,selected:l,rowsPerPage:c,onSelectRow:_,onResetPage:T,onChangePage:y,onSelectAllRows:$,onChangeRowsPerPage:E}}function ye(){return s.jsxs(s.Fragment,{children:[s.jsx(de,{children:s.jsxs("title",{children:[" ",`Users - ${ue.appName}`]})}),s.jsx(Ce,{})]})}export{ye as default};
