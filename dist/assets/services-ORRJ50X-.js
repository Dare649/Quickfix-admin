import{j as s,Z as y,$ as g,B as T,T as C,ad as z,ae as W,r as c,o as _,af as B,ag as G,a0 as w,a1 as A,I as m,P as Q,O as U,Q as F,R as L,ah as q,ai as X,aj as E,av as Z,a2 as J,a3 as K,a4 as Y,a5 as V,X as ee,a6 as H,q as se,N as ne,C as te,a7 as ie,a8 as re,a9 as ae,aa as I,ab as ce,ac as oe,H as le,t as de}from"./index-OkOCVtyy.js";function he({searchQuery:e,...t}){return s.jsx(y,{...t,children:s.jsx(g,{align:"center",colSpan:7,children:s.jsxs(T,{sx:{py:15,textAlign:"center"},children:[s.jsx(C,{variant:"h6",sx:{mb:1},children:"Not found"}),s.jsxs(C,{variant:"body2",children:["No results found for Â ",s.jsxs("strong",{children:['"',e,'"']}),".",s.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function xe({emptyRows:e,height:t,sx:n,...i}){return e?s.jsx(y,{sx:{...t&&{height:t*e},...n},...i,children:s.jsx(g,{colSpan:9})}):null}function ge({row:e,selected:t,onSelectRow:n}){var u;const i=z(),a=W(),[o,l]=c.useState(!1),[r,d]=c.useState(""),[b,R]=c.useState(""),[P,S]=c.useState(null),{profile:p}=_(j=>j.auth),k=c.useCallback(j=>{S(j.currentTarget)},[]),f=c.useCallback(()=>{S(null)},[]),h=()=>{const j=q.deleteService((e==null?void 0:e._id)??(e==null?void 0:e.id));X.promise(j,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:x}){var v;i(E(!1)),Z("/services/all");const O=((v=x==null?void 0:x.data)==null?void 0:v.message)||"Service deleted successfully";return l(!1),`${O}`}},error:{render({data:x}){var v,N,D,$;return i(E(!1)),console.log("ERRO ON TOAST HERE :: ",(N=(v=x==null?void 0:x.response)==null?void 0:v.data)==null?void 0:N.message),`${((($=(D=x==null?void 0:x.response)==null?void 0:D.data)==null?void 0:$.message)||(x==null?void 0:x.message)||"")??"An error occurred!"}`}}})};return s.jsxs(s.Fragment,{children:[s.jsx(B,{open:o,setOpen:l,title:r,body:s.jsx(G,{setOpen:l,message:b,action:()=>h()})}),s.jsxs(y,{hover:!0,tabIndex:-1,role:"checkbox",selected:t,children:[s.jsx(g,{padding:"checkbox",children:s.jsx(w,{disableRipple:!0,checked:t,onChange:n})}),s.jsx(g,{component:"th",scope:"row",children:s.jsx(T,{gap:2,display:"flex",alignItems:"center",children:s.jsx("img",{alt:e.name,src:e.icon_url,width:64})})}),s.jsx(g,{children:e.title}),s.jsx(g,{children:e.description}),s.jsx(g,{children:e.category}),s.jsx(g,{children:(u=e.items)==null?void 0:u.length}),s.jsx(g,{children:(e==null?void 0:e.createdAt)&&new Date(e==null?void 0:e.createdAt).toLocaleDateString("en-US")}),s.jsx(g,{align:"right",children:s.jsx(A,{onClick:k,children:s.jsx(m,{icon:"eva:more-vertical-fill"})})})]}),s.jsx(Q,{open:!!P,anchorEl:P,onClose:f,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:s.jsx(U,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${F.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${F.selected}`]:{bgcolor:"action.selected"}}},children:p&&(p==null?void 0:p.role)!=="support"&&s.jsxs(s.Fragment,{children:[s.jsxs(L,{onClick:()=>{f(),a(`/dashboard/service/${(e==null?void 0:e._id)??(e==null?void 0:e.id)}/update`,{state:{data:e}})},sx:{color:"info.main"},children:[s.jsx(m,{icon:"akar-icons:edit"}),"Update"]}),s.jsxs(L,{onClick:()=>{d("Delete Service"),R("Are you sure you want to delete this service? Action is irreversible."),f(),l(!0)},sx:{color:"error.main"},children:[s.jsx(m,{icon:"fluent:person-delete-24-filled"}),"Delete"]})]})})})]})}const ue={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function pe(e,t,n){return e?Math.max(0,(1+e)*t-n):0}function M(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function je(e,t){return e==="desc"?(n,i)=>M(n,i,t):(n,i)=>-M(n,i,t)}function me({inputData:e,comparator:t,filterName:n}){const i=e.map((a,o)=>[a,o]);return i.sort((a,o)=>{const l=t(a[0],o[0]);return l!==0?l:a[1]-o[1]}),e=i.map(a=>a[0]),n&&(e=e.filter(a=>`${a.region} ${a.city}`.toLowerCase().indexOf(n.toLowerCase())!==-1)),e}function be({order:e,onSort:t,orderBy:n,rowCount:i,headLabel:a,numSelected:o,onSelectAllRows:l}){return s.jsx(J,{children:s.jsxs(y,{children:[s.jsx(g,{padding:"checkbox",children:s.jsx(w,{indeterminate:o>0&&o<i,checked:i>0&&o===i,onChange:r=>l(r.target.checked)})}),a.map(r=>s.jsx(g,{align:r.align||"left",sortDirection:n===r.id?e:!1,sx:{width:r.width,minWidth:r.minWidth},children:s.jsxs(K,{hideSortIcon:!0,active:n===r.id,direction:n===r.id?e:"asc",onClick:()=>t(r.id),children:[r.label,n===r.id?s.jsx(T,{sx:{...ue},children:e==="desc"?"sorted descending":"sorted ascending"}):null]})},r.id))]})})}function fe({numSelected:e,filterName:t,onFilterName:n}){return s.jsxs(Y,{sx:{height:96,display:"flex",justifyContent:"space-between",p:i=>i.spacing(0,1,0,3),...e>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[e>0?s.jsxs(C,{component:"div",variant:"subtitle1",children:[e," selected"]}):s.jsx(V,{fullWidth:!0,value:t,onChange:n,placeholder:"Search service...",startAdornment:s.jsx(ee,{position:"start",children:s.jsx(m,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),e>0?s.jsx(H,{title:"Delete",children:s.jsx(A,{children:s.jsx(m,{icon:"solar:trash-bin-trash-bold"})})}):s.jsx(H,{title:"Filter list",children:s.jsx(A,{children:s.jsx(m,{icon:"ic:round-filter-list"})})})]})}function ve(){var r;const e=Pe(),t=W(),[n,i]=c.useState(""),{services:a}=_(d=>d.service),o=me({inputData:a??[],comparator:je(e.order,e.orderBy),filterName:n}),l=!o.length&&!!n;return s.jsxs(se,{children:[s.jsxs(T,{display:"flex",alignItems:"center",mb:5,children:[s.jsx(C,{variant:"h4",flexGrow:1,children:"Services"}),s.jsx(ne,{variant:"contained",color:"inherit",onClick:()=>t("/dashboard/service/add"),startIcon:s.jsx(m,{icon:"mingcute:add-line"}),children:"New Service"})]}),s.jsxs(te,{children:[s.jsx(fe,{numSelected:e.selected.length,filterName:n,onFilterName:d=>{i(d.target.value),e.onResetPage()}}),s.jsx(ie,{children:s.jsx(re,{sx:{overflow:"unset"},children:s.jsxs(ae,{sx:{minWidth:800},children:[s.jsx(be,{order:e.order,orderBy:e.orderBy,rowCount:I.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:d=>e.onSelectAllRows(d,I.map(b=>b.id)),headLabel:[{id:"icon_url",label:"Icon"},{id:"title",label:"Title"},{id:"description",label:"Description"},{id:"category",label:"Category"},{id:"items",label:"Items"},{id:"createdAt",label:"Created On"},{id:""}]}),s.jsxs(ce,{children:[(r=o==null?void 0:o.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage))==null?void 0:r.map(d=>s.jsx(ge,{row:d,selected:e.selected.includes(d.id),onSelectRow:()=>e.onSelectRow(d.id)},d.id)),s.jsx(xe,{height:68,emptyRows:pe(e.page,e.rowsPerPage,I.length)}),l&&s.jsx(he,{searchQuery:n})]})]})})}),s.jsx(oe,{component:"div",page:e.page,count:a==null?void 0:a.length,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,rowsPerPageOptions:[25],onRowsPerPageChange:e.onChangeRowsPerPage})]})]})}function Pe(){const[e,t]=c.useState(0),[n,i]=c.useState("name"),[a,o]=c.useState(5),[l,r]=c.useState([]),[d,b]=c.useState("asc"),R=c.useCallback(h=>{b(n===h&&d==="asc"?"desc":"asc"),i(h)},[d,n]),P=c.useCallback((h,u)=>{if(h){r(u);return}r([])},[]),S=c.useCallback(h=>{const u=l.includes(h)?l.filter(j=>j!==h):[...l,h];r(u)},[l]),p=c.useCallback(()=>{t(0)},[]),k=c.useCallback((h,u)=>{t(u)},[]),f=c.useCallback(h=>{o(parseInt(h.target.value,10)),p()},[p]);return{page:e,order:d,onSort:R,orderBy:n,selected:l,rowsPerPage:a,onSelectRow:S,onResetPage:p,onChangePage:k,onSelectAllRows:P,onChangeRowsPerPage:f}}function Ce(){return s.jsxs(s.Fragment,{children:[s.jsx(le,{children:s.jsxs("title",{children:[" ",`Services - ${de.appName}`]})}),s.jsx(ve,{})]})}export{Ce as default};
