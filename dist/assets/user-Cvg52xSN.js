import{j as s,a4 as O,a5 as g,B as U,T as A,aj as Y,a6 as B,r as o,ak as K,al as V,a7 as z,V as G,I as p,R as q,K as D,Y as Q,Z,$ as F,a0 as _,am as L,an as N,ao as v,a8 as J,a9 as X,aa as w,ab as ee,a2 as se,ac as H,o as ne,p as te,C as re,ad as ae,ae as ie,af as le,ag as M,ah as ce,ai as oe,H as de,q as ue}from"./index-Dyb8Ibl-.js";function he({searchQuery:e,...i}){return s.jsx(O,{...i,children:s.jsx(g,{align:"center",colSpan:7,children:s.jsxs(U,{sx:{py:15,textAlign:"center"},children:[s.jsx(A,{variant:"h6",sx:{mb:1},children:"Not found"}),s.jsxs(A,{variant:"body2",children:["No results found for Â ",s.jsxs("strong",{children:['"',e,'"']}),".",s.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function ge({row:e,selected:i,onSelectRow:t}){const r=Y(),c=B(),[u,a]=o.useState(!1),[l,C]=o.useState(""),[I,y]=o.useState(""),[k,$]=o.useState(null),R=o.useCallback(x=>{$(x.currentTarget)},[]),S=o.useCallback(()=>{$(null)},[]),E=()=>{const x={...e,status:"suspended"},T=L.updateUser(x);N.promise(T,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:n}){var d;r(v(!1));const f=((d=n==null?void 0:n.data)==null?void 0:d.message)||"User account suspended successfully";return a(!1),`${f}`}},error:{render({data:n}){var d,j,b,P;return r(v(!1)),console.log("ERRO ON TOAST HERE :: ",(j=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:j.message),`${(((P=(b=n==null?void 0:n.response)==null?void 0:b.data)==null?void 0:P.message)||(n==null?void 0:n.message)||"")??"An error occurred!"}`}}})},h=()=>{const x={...e,status:"active"},T=L.updateUser(x);N.promise(T,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:n}){var d;r(v(!1));const f=((d=n==null?void 0:n.data)==null?void 0:d.message)||"User account suspended successfully";return a(!1),`${f}`}},error:{render({data:n}){var d,j,b,P;return r(v(!1)),console.log("ERRO ON TOAST HERE :: ",(j=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:j.message),`${(((P=(b=n==null?void 0:n.response)==null?void 0:b.data)==null?void 0:P.message)||(n==null?void 0:n.message)||"")??"An error occurred!"}`}}})},m=()=>{const x={...e,status:"deleted"},T=L.updateUser(x);N.promise(T,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:n}){var d;r(v(!1));const f=((d=n==null?void 0:n.data)==null?void 0:d.message)||"User account suspended successfully";return a(!1),`${f}`}},error:{render({data:n}){var d,j,b,P;return r(v(!1)),console.log("ERRO ON TOAST HERE :: ",(j=(d=n==null?void 0:n.response)==null?void 0:d.data)==null?void 0:j.message),`${(((P=(b=n==null?void 0:n.response)==null?void 0:b.data)==null?void 0:P.message)||(n==null?void 0:n.message)||"")??"An error occurred!"}`}}})};return s.jsxs(s.Fragment,{children:[s.jsx(K,{open:u,setOpen:a,title:l,body:s.jsx(V,{setOpen:a,message:I,action:()=>l.toLowerCase().startsWith("suspend")?E():l.toLowerCase().startsWith("pardon")?h():l.toLowerCase().startsWith("delete")?m():{}})}),s.jsxs(O,{hover:!0,tabIndex:-1,role:"checkbox",selected:i,children:[s.jsx(g,{padding:"checkbox",children:s.jsx(z,{disableRipple:!0,checked:i,onChange:t})}),s.jsx(g,{component:"th",scope:"row",children:s.jsxs(U,{gap:2,display:"flex",alignItems:"center",children:[s.jsx(G,{alt:e.name,src:e.photoUrl}),`${e.first_name} ${e.last_name}`]})}),s.jsx(g,{children:e.email_address}),s.jsx(g,{children:e.international_phone_format}),s.jsx(g,{children:(e==null?void 0:e.dob)&&new Date(e==null?void 0:e.dob).toLocaleDateString("en-US")}),s.jsx(g,{align:"center",children:e.is_email_verified?s.jsx(p,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}}):"-"}),s.jsx(g,{align:"center",children:e.is_profile_set?s.jsx(p,{width:22,icon:"solar:check-circle-bold",sx:{color:"success.main"}}):s.jsx(p,{width:22,icon:"solar:check-circle-bold",sx:{color:"warning.main"}})}),s.jsx(g,{children:s.jsx(q,{label:e.status,sx:{color:e.status==="active"?"green":"red",textTransform:"capitalize"}})}),s.jsx(g,{align:"right",children:s.jsx(D,{onClick:R,children:s.jsx(p,{icon:"eva:more-vertical-fill"})})})]}),s.jsx(Q,{open:!!k,anchorEl:k,onClose:S,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:s.jsxs(Z,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${F.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${F.selected}`]:{bgcolor:"action.selected"}}},children:[s.jsxs(_,{onClick:()=>{c(`/dashboard/users/${e==null?void 0:e.id}`,{state:{data:e}})},children:[s.jsx(p,{icon:"solar:eye-bold"}),"View"]}),(e==null?void 0:e.status)==="active"?s.jsxs(_,{onClick:()=>{C(`Suspend ${e==null?void 0:e.first_name}`),y(`Are you sure you want to suspend ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name}? You can pardon this user later.`),S(),a(!0)},sx:{color:"warning.main"},children:[s.jsx(p,{icon:"lsicon:suspend-filled"}),"Suspend"]}):s.jsxs(_,{onClick:()=>{C(`Pardon ${e==null?void 0:e.first_name}`),y(`Are you sure you want to pardon ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name}? You can always suspend this user later.`),S(),a(!0)},sx:{color:"info.main"},children:[s.jsx(p,{icon:"mage:user-check-fill"}),"Pardon"]}),(e==null?void 0:e.status)!=="deleted"&&s.jsxs(_,{onClick:()=>{C(`Delete ${e==null?void 0:e.first_name}'s Account`),y(`Are you sure you want to remove ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name} account from the platform? Action is irreversible.`),S(),a(!0)},sx:{color:"error.main"},children:[s.jsx(p,{icon:"fluent:person-delete-24-filled"}),"Delete"]})]})})]})}const pe={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function xe(e,i,t){return e?Math.max(0,(1+e)*i-t):0}function W(e,i,t){return i[t]<e[t]?-1:i[t]>e[t]?1:0}function me(e,i){return e==="desc"?(t,r)=>W(t,r,i):(t,r)=>-W(t,r,i)}function fe({inputData:e,comparator:i,filterName:t}){const r=e.map((c,u)=>[c,u]);return r.sort((c,u)=>{const a=i(c[0],u[0]);return a!==0?a:c[1]-u[1]}),e=r.map(c=>c[0]),t&&(e=e.filter(c=>`${c.first_name} ${c.last_name}`.toLowerCase().indexOf(t.toLowerCase())!==-1)),e}function je({order:e,onSort:i,orderBy:t,rowCount:r,headLabel:c,numSelected:u,onSelectAllRows:a}){return s.jsx(J,{children:s.jsxs(O,{children:[s.jsx(g,{padding:"checkbox",children:s.jsx(z,{indeterminate:u>0&&u<r,checked:r>0&&u===r,onChange:l=>a(l.target.checked)})}),c.map(l=>s.jsx(g,{align:l.align||"left",sortDirection:t===l.id?e:!1,sx:{width:l.width,minWidth:l.minWidth},children:s.jsxs(X,{hideSortIcon:!0,active:t===l.id,direction:t===l.id?e:"asc",onClick:()=>i(l.id),children:[l.label,t===l.id?s.jsx(U,{sx:{...pe},children:e==="desc"?"sorted descending":"sorted ascending"}):null]})},l.id))]})})}function be({emptyRows:e,height:i,sx:t,...r}){return e?s.jsx(O,{sx:{...i&&{height:i*e},...t},...r,children:s.jsx(g,{colSpan:9})}):null}function Pe({numSelected:e,filterName:i,onFilterName:t}){return s.jsxs(w,{sx:{height:96,display:"flex",justifyContent:"space-between",p:r=>r.spacing(0,1,0,3),...e>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[e>0?s.jsxs(A,{component:"div",variant:"subtitle1",children:[e," selected"]}):s.jsx(ee,{fullWidth:!0,value:i,onChange:t,placeholder:"Search user...",startAdornment:s.jsx(se,{position:"start",children:s.jsx(p,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),e>0?s.jsx(H,{title:"Delete",children:s.jsx(D,{children:s.jsx(p,{icon:"solar:trash-bin-trash-bold"})})}):s.jsx(H,{title:"Filter list",children:s.jsx(D,{children:s.jsx(p,{icon:"ic:round-filter-list"})})})]})}function Ce(){const e=Se(),[i,t]=o.useState(""),{users:r}=ne(a=>a.user),c=fe({inputData:r==null?void 0:r.data,comparator:me(e.order,e.orderBy),filterName:i}),u=!c.length&&!!i;return s.jsxs(te,{children:[s.jsx(U,{display:"flex",alignItems:"center",mb:5,children:s.jsx(A,{variant:"h4",flexGrow:1,children:"Users"})}),s.jsxs(re,{children:[s.jsx(Pe,{numSelected:e.selected.length,filterName:i,onFilterName:a=>{t(a.target.value),e.onResetPage()}}),s.jsx(ae,{children:s.jsx(ie,{sx:{overflow:"unset"},children:s.jsxs(le,{sx:{minWidth:800},children:[s.jsx(je,{order:e.order,orderBy:e.orderBy,rowCount:M.length,numSelected:e.selected.length,onSort:e.onSort,onSelectAllRows:a=>e.onSelectAllRows(a,M.map(l=>l.id)),headLabel:[{id:"name",label:"Name"},{id:"email_address",label:"Email Address"},{id:"phone_number",label:"Phone Number"},{id:"dob",label:"DOB"},{id:"isVerified",label:"Verified",align:"center"},{id:"isKYC",label:"KYC Status",align:"center"},{id:"status",label:"Status",align:"center"},{id:""}]}),s.jsxs(ce,{children:[c.slice(e.page*e.rowsPerPage,e.page*e.rowsPerPage+e.rowsPerPage).map(a=>s.jsx(ge,{row:a,selected:e.selected.includes(a.id),onSelectRow:()=>e.onSelectRow(a.id)},a.id)),s.jsx(be,{height:68,emptyRows:xe(e.page,e.rowsPerPage,M.length)}),u&&s.jsx(he,{searchQuery:i})]})]})})}),s.jsx(oe,{component:"div",page:e.page,count:r==null?void 0:r.totalItems,rowsPerPage:e.rowsPerPage,onPageChange:e.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:e.onChangeRowsPerPage})]})]})}function Se(){const[e,i]=o.useState(0),[t,r]=o.useState("name"),[c,u]=o.useState(5),[a,l]=o.useState([]),[C,I]=o.useState("asc"),y=o.useCallback(h=>{I(t===h&&C==="asc"?"desc":"asc"),r(h)},[C,t]),k=o.useCallback((h,m)=>{if(h){l(m);return}l([])},[]),$=o.useCallback(h=>{const m=a.includes(h)?a.filter(x=>x!==h):[...a,h];l(m)},[a]),R=o.useCallback(()=>{i(0)},[]),S=o.useCallback((h,m)=>{i(m)},[]),E=o.useCallback(h=>{u(parseInt(h.target.value,10)),R()},[R]);return{page:e,order:C,onSort:y,orderBy:t,selected:a,rowsPerPage:c,onSelectRow:$,onResetPage:R,onChangePage:S,onSelectAllRows:k,onChangeRowsPerPage:E}}function ye(){return s.jsxs(s.Fragment,{children:[s.jsx(de,{children:s.jsxs("title",{children:[" ",`Users - ${ue.appName}`]})}),s.jsx(Ce,{})]})}export{ye as default};
