import{j as e,a4 as k,a5 as T,B as v,T as w,i as G,aj as I,o as O,aq as K,ar as Q,as as V,ao as R,am as F,an as L,av as $,a1 as X,X as M,a6 as Z,r as g,ak as E,al as J,a7 as Y,K as N,I as y,Y as ee,Z as se,$ as q,a0 as z,a8 as ne,a9 as te,aa as re,ab as oe,a2 as ie,ac as U,p as le,C as ae,ad as ce,ae as de,af as ue,ag as A,ah as he,ai as ge,H as pe,q as xe}from"./index-Ca9vWsGo.js";function me({searchQuery:s,...t}){return e.jsx(k,{...t,children:e.jsx(T,{align:"center",colSpan:7,children:e.jsxs(v,{sx:{py:15,textAlign:"center"},children:[e.jsx(w,{variant:"h6",sx:{mb:1},children:"Not found"}),e.jsxs(w,{variant:"body2",children:["No results found for Â ",e.jsxs("strong",{children:['"',s,'"']}),".",e.jsx("br",{})," Try checking for typos or using complete words."]})]})})})}function je({emptyRows:s,height:t,sx:n,...r}){return s?e.jsx(k,{sx:{...t&&{height:t*s},...n},...r,children:e.jsx(T,{colSpan:9})}):null}const fe=({setOpen:s,reason:t})=>{const n=G(),r=I(),{isLoading:u}=O(f=>f.loader),i=K().shape({title:Q().required("Reason is required")}),h=V({initialValues:{title:(t==null?void 0:t.title)??""},validationSchema:i,onSubmit:async f=>{try{r(R(!0));const b={title:f.title},c=F.updateReason(b,(t==null?void 0:t._id)??(t==null?void 0:t.id));L.promise(c,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:a}){var l;r(R(!1)),$("/admins/reasons/all");const j=((l=a==null?void 0:a.data)==null?void 0:l.message)||"Reason updated successfully";return s(!1),`${j}`}},error:{render({data:a}){var l,x,m,p;return r(R(!1)),console.log("ERRO ON TOAST HERE :: ",(x=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:x.message),`${(((p=(m=a==null?void 0:a.response)==null?void 0:m.data)==null?void 0:p.message)||(a==null?void 0:a.message)||"")??"An error occurred!"}`}}})}catch(b){r(R(!1)),console.log("LOCATION ERR :: ",b)}}}),{touched:o,errors:d,getFieldProps:P,handleSubmit:S}=h;return e.jsxs(v,{p:3,minWidth:320,children:[e.jsx(v,{p:1}),e.jsx(X,{variant:"outlined",fullWidth:!0,placeholder:"Reason",label:"Reason",...P("title"),error:!!(o.title&&d.title),helperText:!!(o.title&&d.title)}),e.jsx(v,{p:2}),e.jsx(M,{fullWidth:!0,disabled:u,variant:"contained",onClick:()=>S(),sx:{bgcolor:n.palette.secondary.main},children:"Update Now"})]})};function be({row:s,selected:t,onSelectRow:n}){const r=I();Z();const[u,i]=g.useState(!1),[h,o]=g.useState(!1),[d,P]=g.useState(""),[S,f]=g.useState(""),[b,c]=g.useState(null),{profile:a}=O(m=>m.auth),j=g.useCallback(m=>{c(m.currentTarget)},[]),l=g.useCallback(()=>{c(null)},[]),x=()=>{const m=F.deleteReason((s==null?void 0:s._id)??(s==null?void 0:s.id));L.promise(m,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:p}){var C;r(R(!1)),$("/admins/reasons/all");const W=((C=p==null?void 0:p.data)==null?void 0:C.message)||"Reason deleted successfully";return i(!1),`${W}`}},error:{render({data:p}){var C,H,B,D;return r(R(!1)),console.log("ERRO ON TOAST HERE :: ",(H=(C=p==null?void 0:p.response)==null?void 0:C.data)==null?void 0:H.message),`${(((D=(B=p==null?void 0:p.response)==null?void 0:B.data)==null?void 0:D.message)||(p==null?void 0:p.message)||"")??"An error occurred!"}`}}})};return e.jsxs(e.Fragment,{children:[e.jsx(E,{open:h,setOpen:o,title:"Update Reason",body:e.jsx(fe,{setOpen:o,reasonData:s})}),e.jsx(E,{open:u,setOpen:i,title:d,body:e.jsx(J,{setOpen:i,message:S,action:()=>x()})}),e.jsxs(k,{hover:!0,tabIndex:-1,role:"checkbox",selected:t,children:[e.jsx(T,{padding:"checkbox",children:e.jsx(Y,{disableRipple:!0,checked:t,onChange:n})}),e.jsx(T,{children:s.title}),e.jsx(T,{align:"right",children:e.jsx(N,{onClick:j,children:e.jsx(y,{icon:"eva:more-vertical-fill"})})})]}),e.jsx(ee,{open:!!b,anchorEl:b,onClose:l,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:e.jsx(se,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${q.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${q.selected}`]:{bgcolor:"action.selected"}}},children:a&&(a==null?void 0:a.role)!=="support"&&e.jsxs(e.Fragment,{children:[e.jsxs(z,{onClick:()=>{l(),o(!0)},sx:{color:"info.main"},children:[e.jsx(y,{icon:"akar-icons:edit"}),"Update"]}),e.jsxs(z,{onClick:()=>{P("Delete Reason"),f("Are you sure you want to delete this reason? Action is irreversible."),l(),i(!0)},sx:{color:"error.main"},children:[e.jsx(y,{icon:"fluent:person-delete-24-filled"}),"Delete"]})]})})})]})}const Re={border:0,margin:-1,padding:0,width:"1px",height:"1px",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",clip:"rect(0 0 0 0)"};function Pe(s,t,n){return s?Math.max(0,(1+s)*t-n):0}function _(s,t,n){return t[n]<s[n]?-1:t[n]>s[n]?1:0}function Se(s,t){return s==="desc"?(n,r)=>_(n,r,t):(n,r)=>-_(n,r,t)}function ve({inputData:s,comparator:t,filterName:n}){const r=s.map((u,i)=>[u,i]);return r.sort((u,i)=>{const h=t(u[0],i[0]);return h!==0?h:u[1]-i[1]}),s=r.map(u=>u[0]),n&&(s=s.filter(u=>`${u.title}`.toLowerCase().indexOf(n.toLowerCase())!==-1)),s}function Te({order:s,onSort:t,orderBy:n,rowCount:r,headLabel:u,numSelected:i,onSelectAllRows:h}){return e.jsx(ne,{children:e.jsxs(k,{children:[e.jsx(T,{padding:"checkbox",children:e.jsx(Y,{indeterminate:i>0&&i<r,checked:r>0&&i===r,onChange:o=>h(o.target.checked)})}),u.map(o=>e.jsx(T,{align:o.align||"left",sortDirection:n===o.id?s:!1,sx:{width:o.width,minWidth:o.minWidth},children:e.jsxs(te,{hideSortIcon:!0,active:n===o.id,direction:n===o.id?s:"asc",onClick:()=>t(o.id),children:[o.label,n===o.id?e.jsx(v,{sx:{...Re},children:s==="desc"?"sorted descending":"sorted ascending"}):null]})},o.id))]})})}function ye({numSelected:s,filterName:t,onFilterName:n}){return e.jsxs(re,{sx:{height:96,display:"flex",justifyContent:"space-between",p:r=>r.spacing(0,1,0,3),...s>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:[s>0?e.jsxs(w,{component:"div",variant:"subtitle1",children:[s," selected"]}):e.jsx(oe,{fullWidth:!0,value:t,onChange:n,placeholder:"Search reason...",startAdornment:e.jsx(ie,{position:"start",children:e.jsx(y,{width:20,icon:"eva:search-fill",sx:{color:"text.disabled"}})}),sx:{maxWidth:320}}),s>0?e.jsx(U,{title:"Delete",children:e.jsx(N,{children:e.jsx(y,{icon:"solar:trash-bin-trash-bold"})})}):e.jsx(U,{title:"Filter list",children:e.jsx(N,{children:e.jsx(y,{icon:"ic:round-filter-list"})})})]})}function Ce(){const s=we(),[t,n]=g.useState(!1),[r,u]=g.useState(""),{reasons:i}=O(d=>d.misc);console.log(" REASON AM NA :: ",i);const h=ve({inputData:i,comparator:Se(s.order,s.orderBy),filterName:r}),o=!h.length&&!!r;return e.jsxs(le,{children:[e.jsx(E,{open:t,setOpen:n,title:"Add New Reason",body:e.jsx(ke,{setOpen:n})}),e.jsxs(v,{display:"flex",alignItems:"center",mb:5,children:[e.jsx(w,{variant:"h4",flexGrow:1,children:"Reasons"}),e.jsx(M,{variant:"contained",color:"inherit",onClick:()=>n(!0),startIcon:e.jsx(y,{icon:"mingcute:add-line"}),children:"New Reason"})]}),e.jsxs(ae,{children:[e.jsx(ye,{numSelected:s.selected.length,filterName:r,onFilterName:d=>{u(d.target.value),s.onResetPage()}}),e.jsx(ce,{children:e.jsx(de,{sx:{overflow:"unset"},children:e.jsxs(ue,{sx:{minWidth:800},children:[e.jsx(Te,{order:s.order,orderBy:s.orderBy,rowCount:A.length,numSelected:s.selected.length,onSort:s.onSort,onSelectAllRows:d=>s.onSelectAllRows(d,A.map(P=>P.id)),headLabel:[{id:"title",label:"Reason"},{id:""}]}),e.jsxs(he,{children:[h.slice(s.page*s.rowsPerPage,s.page*s.rowsPerPage+s.rowsPerPage).map(d=>e.jsx(be,{row:d,selected:s.selected.includes(d.id),onSelectRow:()=>s.onSelectRow(d.id)},d.id)),e.jsx(je,{height:68,emptyRows:Pe(s.page,s.rowsPerPage,A.length)}),o&&e.jsx(me,{searchQuery:r})]})]})})}),e.jsx(ge,{component:"div",page:s.page,count:i==null?void 0:i.length,rowsPerPage:s.rowsPerPage,onPageChange:s.onChangePage,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:s.onChangeRowsPerPage})]})]})}function we(){const[s,t]=g.useState(0),[n,r]=g.useState("name"),[u,i]=g.useState(5),[h,o]=g.useState([]),[d,P]=g.useState("asc"),S=g.useCallback(l=>{P(n===l&&d==="asc"?"desc":"asc"),r(l)},[d,n]),f=g.useCallback((l,x)=>{if(l){o(x);return}o([])},[]),b=g.useCallback(l=>{const x=h.includes(l)?h.filter(m=>m!==l):[...h,l];o(x)},[h]),c=g.useCallback(()=>{t(0)},[]),a=g.useCallback((l,x)=>{t(x)},[]),j=g.useCallback(l=>{i(parseInt(l.target.value,10)),c()},[c]);return{page:s,order:d,onSort:S,orderBy:n,selected:h,rowsPerPage:u,onSelectRow:b,onResetPage:c,onChangePage:a,onSelectAllRows:f,onChangeRowsPerPage:j}}const ke=({setOpen:s})=>{const t=G(),n=I(),{isLoading:r}=O(S=>S.loader),u=K().shape({title:Q().required("Title is required")}),i=V({initialValues:{title:""},validationSchema:u,onSubmit:async S=>{try{n(R(!0));const f={title:S.title},b=F.addReason(f);L.promise(b,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:c}){var j;n(R(!1)),$("/admins/reasons/all");const a=((j=c==null?void 0:c.data)==null?void 0:j.message)||"New reason added successfully";return s(!1),`${a}`}},error:{render({data:c}){var j,l,x,m;return n(R(!1)),console.log("ERRO ON TOAST HERE :: ",(l=(j=c==null?void 0:c.response)==null?void 0:j.data)==null?void 0:l.message),`${(((m=(x=c==null?void 0:c.response)==null?void 0:x.data)==null?void 0:m.message)||(c==null?void 0:c.message)||"")??"An error occurred!"}`}}})}catch(f){n(R(!1)),console.log("REASON ERR :: ",f)}}}),{touched:h,errors:o,getFieldProps:d,handleSubmit:P}=i;return e.jsxs(v,{p:3,minWidth:320,children:[e.jsx(X,{variant:"outlined",fullWidth:!0,placeholder:"Reason",label:"Reason",...d("title"),error:!!(h.title&&o.title),helperText:h.title&&o.title}),e.jsx(v,{p:2}),e.jsx(M,{fullWidth:!0,disabled:r,variant:"contained",onClick:()=>P(),sx:{bgcolor:t.palette.secondary.main},children:"Submit"})]})};function Ae(){return e.jsxs(e.Fragment,{children:[e.jsx(pe,{children:e.jsxs("title",{children:[" ",`Reasons - ${xe.appName}`]})}),e.jsx(Ce,{})]})}export{Ae as default};
