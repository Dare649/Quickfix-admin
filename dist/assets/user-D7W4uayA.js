import{ad as z,ae as M,r as c,o as U,j as t,af as L,ag as k,a1 as I,I as y,P as D,O as B,Q as T,R as O,ah as P,ai as N,aj as p,ak as F,al as G,am as H,an as W,K as V,ao as Y,q,B as K,T as Q,C as J,H as X,t as Z}from"./index-DCSkPGta.js";const w=({row:e})=>{const a=z(),_=M(),[$,i]=c.useState(!1),[m,j]=c.useState(""),[u,C]=c.useState(""),[n,l]=c.useState(null),{profile:r}=U(d=>d.auth),S=c.useCallback(d=>{l(d.currentTarget)},[]),A=c.useCallback(()=>{l(null)},[]),b=()=>{const d={...e,status:"suspended"},v=P.updateUser(d);N.promise(v,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:s}){var o;a(p(!1));const g=((o=s==null?void 0:s.data)==null?void 0:o.message)||"User account suspended successfully";return i(!1),`${g}`}},error:{render({data:s}){var o,f,h,x;return a(p(!1)),console.log("ERRO ON TOAST HERE :: ",(f=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:f.message),`${(((x=(h=s==null?void 0:s.response)==null?void 0:h.data)==null?void 0:x.message)||(s==null?void 0:s.message)||"")??"An error occurred!"}`}}})},E=()=>{const d={...e,status:"active"},v=P.updateUser(d);N.promise(v,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:s}){var o;a(p(!1));const g=((o=s==null?void 0:s.data)==null?void 0:o.message)||"User account suspended successfully";return i(!1),`${g}`}},error:{render({data:s}){var o,f,h,x;return a(p(!1)),console.log("ERRO ON TOAST HERE :: ",(f=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:f.message),`${(((x=(h=s==null?void 0:s.response)==null?void 0:h.data)==null?void 0:x.message)||(s==null?void 0:s.message)||"")??"An error occurred!"}`}}})},R=()=>{const d={...e,status:"deleted"},v=P.updateUser(d);N.promise(v,{pending:{render(){return"Loading. Please wait..."},icon:!1},success:{render({data:s}){var o;a(p(!1));const g=((o=s==null?void 0:s.data)==null?void 0:o.message)||"User account suspended successfully";return i(!1),`${g}`}},error:{render({data:s}){var o,f,h,x;return a(p(!1)),console.log("ERRO ON TOAST HERE :: ",(f=(o=s==null?void 0:s.response)==null?void 0:o.data)==null?void 0:f.message),`${(((x=(h=s==null?void 0:s.response)==null?void 0:h.data)==null?void 0:x.message)||(s==null?void 0:s.message)||"")??"An error occurred!"}`}}})};return t.jsxs(t.Fragment,{children:[t.jsx(L,{open:$,setOpen:i,title:m,body:t.jsx(k,{setOpen:i,message:u,action:()=>m.toLowerCase().startsWith("suspend")?b():m.toLowerCase().startsWith("pardon")?E():m.toLowerCase().startsWith("delete")?R():{}})}),t.jsx(I,{onClick:S,children:t.jsx(y,{icon:"eva:more-vertical-fill"})}),t.jsx(D,{open:!!n,anchorEl:n,onClose:A,anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},children:t.jsxs(B,{disablePadding:!0,sx:{p:.5,gap:.5,width:140,display:"flex",flexDirection:"column",[`& .${T.root}`]:{px:1,gap:2,borderRadius:.75,[`&.${T.selected}`]:{bgcolor:"action.selected"}}},children:[t.jsxs(O,{onClick:()=>{_(`/dashboard/users/${e==null?void 0:e.id}`,{state:{data:e}})},children:[t.jsx(y,{icon:"solar:eye-bold"}),"View"]}),r&&(r==null?void 0:r.access)==="read/write"&&((r==null?void 0:r.role)==="manager"||(r==null?void 0:r.role)==="developer")&&(e==null?void 0:e.status)==="active"?t.jsxs(O,{onClick:()=>{j(`Suspend ${e==null?void 0:e.first_name}`),C(`Are you sure you want to suspend ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name}? You can pardon this user later.`),A(),i(!0)},sx:{color:"warning.main"},children:[t.jsx(y,{icon:"lsicon:suspend-filled"}),"Suspend"]}):t.jsxs(O,{onClick:()=>{j(`Pardon ${e==null?void 0:e.first_name}`),C(`Are you sure you want to pardon ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name}? You can always suspend this user later.`),A(),i(!0)},sx:{color:"info.main"},children:[t.jsx(y,{icon:"mage:user-check-fill"}),"Pardon"]}),r&&(r==null?void 0:r.access)==="read/write"&&((r==null?void 0:r.role)==="manager"||(r==null?void 0:r.role)==="developer")&&(e==null?void 0:e.status)!=="deleted"&&t.jsxs(O,{onClick:()=>{j(`Delete ${e==null?void 0:e.first_name}'s Account`),C(`Are you sure you want to remove ${e==null?void 0:e.first_name} ${e==null?void 0:e.last_name} account from the platform? Action is irreversible.`),A(),i(!0)},sx:{color:"error.main"},children:[t.jsx(y,{icon:"fluent:person-delete-24-filled"}),"Delete"]})]})})]})};function ee(){const{users:e}=U(n=>n.user),[a,_]=c.useState({page:0,pageSize:25}),[$,i]=c.useState(!1),[m,j]=c.useState((e==null?void 0:e.data)??[]),{data:u}=F(a.page+1),C=[{field:"user",headerName:"Photo",width:70,renderCell:n=>{var l,r,S;return t.jsx(V,{src:(l=n==null?void 0:n.row)==null?void 0:l.photoUrl,variant:"rounded",children:(S=(r=n==null?void 0:n.row)==null?void 0:r.first_name)==null?void 0:S.slice(0,1)})}},{field:"first_name",headerName:"First Name",flex:1,renderCell:n=>{var l;return t.jsx("p",{style:{textTransform:"capitalize",fontSize:14},children:(l=n==null?void 0:n.row)==null?void 0:l.first_name})}},{field:"last_name",headerName:"Last Name",flex:1,renderCell:n=>{var l;return t.jsx("p",{style:{textTransform:"capitalize",fontSize:14},children:(l=n==null?void 0:n.row)==null?void 0:l.last_name})}},{field:"email_address",headerName:"Email Address",flex:1,renderCell:n=>{var l;return t.jsx("p",{style:{textTransform:"capitalize",fontSize:14},children:(l=n==null?void 0:n.row)==null?void 0:l.email_address})}},{field:"international_phone_format",headerName:"Phone Number",flex:1,renderCell:n=>{var l;return t.jsx("p",{style:{textTransform:"capitalize",fontSize:14},children:`${(l=n==null?void 0:n.row)==null?void 0:l.international_phone_format}`})}},{field:"status",headerName:"Status",width:108,renderCell:n=>t.jsx(Y,{label:n.row.status,sx:{color:n.row.status==="active"?"green":"red",textTransform:"capitalize"}})},{field:"id",headerName:"Action",width:90,renderCell:n=>t.jsx(w,{row:n==null?void 0:n.row})}];return c.useEffect(()=>{let n=!0;return(async()=>(i(!0),u&&(console.log("SECOND PAGE DATA",u),j(u==null?void 0:u.data)),n&&i(!1)))(),()=>{n=!1}},[a.page,u]),t.jsx("div",{style:{height:"75vh",width:"100%",padding:10},children:e&&(e==null?void 0:e.data)&&m&&t.jsx(G,{sx:{padding:1},rows:m,columns:C,paginationMode:"server",pageSizeOptions:[25],rowCount:e==null?void 0:e.totalItems,paginationModel:a,onPaginationModelChange:_,loading:$,slots:{noRowsOverlay:H,toolbar:W}})})}function se(){return t.jsxs(q,{children:[t.jsx(K,{display:"flex",alignItems:"center",mb:5,children:t.jsx(Q,{variant:"h4",flexGrow:1,children:"Users"})}),t.jsx(J,{children:t.jsx(ee,{})})]})}function te(){return t.jsxs(t.Fragment,{children:[t.jsx(X,{children:t.jsxs("title",{children:[" ",`Users - ${Z.appName}`]})}),t.jsx(se,{})]})}export{te as default};
